<!DOCTYPE html>
<html lang="en">
<head>
    <title>Recovery Resources</title>
    <!-- UIkit CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.6.22/css/uikit.min.css" />
    <!-- UIkit JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.6.22/js/uikit.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.6.22/js/uikit-icons.min.js"></script>
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.3/font/bootstrap-icons.min.css" integrity="sha512-dPXYcDub/aeb08c63jRq/k6GaKccl256JQy/AnOq7CAnEZ9FzSL9wSbcZkMp4R26vBsMLFYH4kQ67/bbV8XaCQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- Bootstrap 5 CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/css/bootstrap.min.css" integrity="sha512-jnSuA4Ss2PkkikSOLtYs8BlYIeeIK1h99ty4YfvRPAlzr377vr3CXDb7sb7eEEBYjDtcYj+AjBH3FLv5uSJuXg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- Custom Colors CSS -->
    <link rel="stylesheet" href="https://resourcespage.pages.dev/customColors.css" />

    <style>
        body {
            font-family: 'Oxygen';
        }
    </style>
    <script src="resourcesData.js"></script>
</head>
<body id="page-top" class="bg-success-subtle">
<div class="uk-section">
    <!-- Page Wrapper -->
    <div id="wrapper">
        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column">
            <!-- Main Content -->
            <div id="content">
                <br /><br />
                <!-- Begin Page Content -->
                <div class="container">
                    <div class="card-body">
                        <br />
                        <!-- Search Box -->
                        <div class="bg-light shadow py-4 px-3 mt-2" style="border-radius: 35px 35px 5px 5px">
                            <div class="uk-container">
                                <form class="uk-search uk-search-default w-100">
                                    <div class="input-group bg-gray-subtle rounded">
                                        <input class="form-control border-0 bg-gray-subtle py-1 px-4" type="search" placeholder="Search..." id="search-box" />
                                                                <div class="input-group-append kbd">
                                <button type="button" aria-label="Search (Ctrl+K)" class="border-0 bg-gray-subtle text-black py-1 px-3 d-flex" data-bs-toggle="modal" data-bs-target="#searchModal">
                                    <span><kbd>CTRL</kbd> + <kbd>K</kbd></span>
                                </button>
                            </div>
                                                                <div class="input-group-append">
                                <button class="btn customButton--secondary py-1 px-5" type="button" style="border-radius: 1px 10px 10px 1px !important">
                                    <span class="bi bi-search"></span>
                                </button>
                            </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <!-- Filter Container -->
                        <div class="uk-container uk-margin">
                            <nav class="uk-navbar-container" uk-navbar>
                                <div class="uk-navbar-left">
                                    <ul class="uk-navbar-nav">
                                        <li>
                                            <a href="#">Counties <span uk-icon="icon: triangle-down"></span></a>
                                            <div class="uk-navbar-dropdown" uk-dropdown="mode: click">
                                                <ul class="uk-nav uk-navbar-dropdown-nav">
                                                    <li><label><input class="uk-checkbox county-filter" type="checkbox" value="Philadelphia" /> Philadelphia</label></li>
                                                    <li><label><input class="uk-checkbox county-filter" type="checkbox" value="Berks" /> Berks</label></li>
                                                    <li><label><input class="uk-checkbox county-filter" type="checkbox" value="Bucks" /> Bucks</label></li>
                                                    <li><label><input class="uk-checkbox county-filter" type="checkbox" value="Chester" /> Chester</label></li>
                                                    <li><label><input class="uk-checkbox county-filter" type="checkbox" value="Delaware" /> Delaware</label></li>
                                                    <li><label><input class="uk-checkbox county-filter" type="checkbox" value="Lancaster" /> Lancaster</label></li>
                                                    <li><label><input class="uk-checkbox county-filter" type="checkbox" value="Montgomery" /> Montgomery</label></li>
                                                    <li><label><input class="uk-checkbox county-filter" type="checkbox" value="Schuylkill" /> Schuylkill</label></li>
                                                </ul>
                                            </div>
                                        </li>
                                        <li>
                                            <a href="#">Domains <span uk-icon="icon: triangle-down"></span></a>
                                            <div class="uk-navbar-dropdown" uk-dropdown="mode: click">
                                                <ul class="uk-nav uk-navbar-dropdown-nav">
                                                    <li><label><input class="uk-checkbox domain-filter" type="checkbox" value="Recovery Support" /> Recovery Support</label></li>
                                                    <li><label><input class="uk-checkbox domain-filter" type="checkbox" value="Family Support" /> Family Support</label></li>
                                                    <li><label><input class="uk-checkbox domain-filter" type="checkbox" value="Housing" /> Housing</label></li>
                                                    <li><label><input class="uk-checkbox domain-filter" type="checkbox" value="Transportation" /> Transportation</label></li>
                                                </ul>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </nav>
                        </div>
                        <!-- Cards Container -->
                        <div class="uk-container uk-margin">
                            <div class="uk-grid-small uk-child-width-1-3@m js-filter" uk-grid>
                                <!-- Cards will be populated here -->
                            </div>
                        </div>   
                    </div>
                </div>
                <!-- /.container-fluid -->
            </div>
            <!-- End of Main Content -->
        </div>
        <!-- End of Content Wrapper -->
    </div>
    <!-- End of Page Wrapper -->
    <!-- UIkit JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.6.22/js/uikit.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.6.22/js/uikit-icons.min.js"></script>
    <!-- Custom scripts -->
    <script src="resourcesData.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const container = document.querySelector(".uk-grid-small");
            jsonData.forEach((item) => {
                const populations = item["Populations Served"].split(";").map((pop) => `<span class="uk-label uk-label-danger">${pop.trim()}</span>`).join(" ");
                const counties = item["County"].split(";").map((county) => `<span class="uk-label uk-label-warning">${county.trim()} County</span>`).join(" ");
                const card = `
                    <div class="js-filter-item" data-county="${item.County}" data-domain="${item.Domain}">
                        <div class="uk-card uk-card-default">
                            <div class="uk-card-header">
                                <div class="uk-align-left">
                                    <div class="uk-width-auto">
                                        <span class="uk-label uk-label-primary">
                                        ${item.Domain}
                                        </span>
                                    </div>
                                    <div class="uk-width-auto">
                                        <span class="uk-label uk-label-success">
                                        ${item.Category}
                                        </span>
                                    </div>
                                </div>
                                <div class="uk-align-right">
                                    <div class="uk-width-auto">
                                    ${counties}
                                    </div>
                                </div>
                            </div>
                            <div class="uk-card-body">
                                <h3 class="uk-card-title">${item["Location Name"]}</h3>
                                <h5>${item.Organization}</h5>
                                ${item.Image ? `<img src="${item.Image}" alt="Logo" style="max-width:100px; max-height:100px; float:left; margin-right:10px;">` : ""}
                                <p><strong>Phone:</strong> ${item.Phone}</p>
                                <p>${item.Address}</p>
                                <p>${item.City}, ${item.State} ${item["Zip Code"]}</p>
                                <br />
                                <p><strong>Populations Served:</strong> ${populations}</p>
                                <br />
                                <a href="${item.Website}" target="_blank">Website</a>
                            </div>
                        </div>
                    </div>
                `;
                container.insertAdjacentHTML('beforeend', card);
            });

            // Search functionality
            document.getElementById("search-box").addEventListener("keyup", function () {
                const searchTerm = this.value.toLowerCase();
                document.querySelectorAll(".js-filter-item").forEach(function (item) {
                    const text = item.textContent.toLowerCase();
                    item.style.display = text.includes(searchTerm) ? "" : "none";
                });
            });

            // Filter functionality
            document.querySelectorAll("input.uk-checkbox").forEach(function (checkbox) {
                checkbox.addEventListener("change", function () {
                    const selectedCounties = Array.from(document.querySelectorAll("input.county-filter:checked")).map(function (checkbox) {
                        return checkbox.value;
                    });
                    const selectedDomains = Array.from(document.querySelectorAll("input.domain-filter:checked")).map(function (checkbox) {
                        return checkbox.value;
                    });

                    document.querySelectorAll(".js-filter-item").forEach(function (item) {
                        const itemCounty = item.getAttribute("data-county");
                        const itemDomain = item.getAttribute("data-domain");
                        const showCounty = selectedCounties.length === 0 || selectedCounties.includes(itemCounty);
                        const showDomain = selectedDomains.length === 0 || selectedDomains.includes(itemDomain);
                        item.style.display = showCounty && showDomain ? "" : "none";
                    });
                });
            });
        });
    </script>
</div>
</body>
</html>