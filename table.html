<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Resources Table</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-4">

  <div class="container">
    <h2 class="mb-4">Resources Table</h2>
    <div id="table-container" class="table-responsive"></div>
  </div>

  <script>
    const dataUrl = "https://resourcesdatabaseproxy.crodican.workers.dev/?limit=999999";

    fetch(dataUrl)
      .then(response => {
        if (!response.ok) throw new Error('Failed to fetch data');
        return response.json();
      })
      .then(data => {
        const rows = data.list;

        if (!Array.isArray(rows) || rows.length === 0) {
          document.getElementById("table-container").innerHTML = "<p>No data available.</p>";
          return;
        }

        const table = document.createElement("table");
        table.className = "table table-striped table-bordered table-sm";

        // Header
        const thead = table.createTHead();
        const headerRow = thead.insertRow();
        const columns = Object.keys(rows[0]);
        columns.forEach(key => {
          const th = document.createElement("th");
          th.textContent = key;
          headerRow.appendChild(th);
        });

        // Body
        const tbody = table.createTBody();
        rows.forEach(row => {
          const tr = tbody.insertRow();
          columns.forEach(col => {
            const td = tr.insertCell();
            const value = row[col];
            td.textContent = value === null ? "" : (typeof value === "object" ? JSON.stringify(value) : value);
          });
        });

        document.getElementById("table-container").appendChild(table);
      })
      .catch(error => {
        document.getElementById("table-container").innerHTML =
          `<p class="text-danger">Error loading data: ${error.message}</p>`;
      });
  </script>

</body>
</html>
